start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
set.seed(20882)
launch_loop <- 5
total_iter <- 10
start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
total_run
test_result
t(test_result$alpha_update)[2400:2500, ]
test_result
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
knitr::opts_chunk$set(echo = TRUE)
library(Rcpp)
library(RcppArmadillo)
library(devtools)
library(DirichletReg)
library(salso)
library(ClusterProj)
set.seed(20882)
launch_loop <- 5
total_iter <- 10
start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
total_run <- Sys.time() - start_time
test_result
set.seed(20882)
launch_loop <- 5
total_iter <- 1000
start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
total_run <- Sys.time() - start_time
set.seed(20882)
launch_loop <- 10
total_iter <- 2500
start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
total_run <- Sys.time() - start_time
total_run
test_result
t(test_result$alpha_update)[2400:2500, ]
salso_object <- salso(t(test_result$clus_assign[, -(1:500)]))
summary(salso_object)
plot(summary(salso_object))
set.seed(20882)
launch_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_result <- cluster_func(6, ci_init, alpha_init, xi, data_test, gamma_hyper,
a_theta, b_theta, launch_loop, total_iter)
total_run <- Sys.time() - start_time
total_run
test_result
t(test_result$alpha_update)[9001:100001, ]
t(test_result$alpha_update)[9001:10001, ]
salso_object <- salso(t(test_result$clus_assign[, -(1:1000)]))
summary(salso_object)
plot(summary(salso_object))
psm(t(test_result$clus_assign[, -(1:1000)]))
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- c(10, 15, 20)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10, 1, 1, 1, 10, 10, 10),
nrow = 3))
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
sum_y <- rpois(30, 5)
data_test <- matrix(NA, ncol = 3, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
data_test
ci
gamma_hyper
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- c(10, 15, 20)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10), nrow = 3))
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
sum_y <- rpois(30, 5)
data_test <- matrix(NA, ncol = 3, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
gamma_hyper
nu_k
round(nu_k, 4)
table(ci)
### Hyperparameter
gamma_init <- t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10, 1, 1, 1, 10, 10, 10),
nrow = 3))
gamma_init
### Hyperparameter
set.seed(20882)
xi_init <- rep(20, 5)
rgamma(5, xi_init, 1)
### Hyperparameter
set.seed(20882)
gamma_init <- t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10, 1, 1, 1, 10, 10, 10),
nrow = 3))
ci_init <- rep(1, 30)
xi_init <- rep(20, 5)
alpha_init <- rgamma(5, xi_init, 1)
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, 0.5, 0.5, 10, 1000)
t(test_final$alpha_update)
t(test_final$alpha_update)[976:1001, ]
set.seed(20882)
gamma_init <- t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10, 1, 1, 1, 10, 10, 10),
nrow = 3))
ci_init <- rep(1, 30)
xi_init <- rep(20, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
?salso
t(test_result$clus_assign)
t(test_result$alpha_update)
t(test_final$alpha_update)
t(test_final$clus_assign)
t(test_final$clus_assign)[, -(1:1000)]
t(test_final$clus_assign)[, -(1:1000)]
t(test_final$clus_assign)
t(test_final$clus_assign)[-(1:1000), ]
salso(t(test_final$clus_assign)[-(1:1000), ])
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary(salso_object)
summary_salso <- summary(salso_object)
summary_salso$estimate
table(summary_salso$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- c(5, 7.5, 7.5, 5)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
table(ci)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
table(ci)
t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10), nrow = 3))
diag(4)
cbind(diag(4), rep(1, 4))
cbind(diag(4), rep(1, 4)) * 10
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
gamma_hyper
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
round(nu_k, 4)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
gamma_hyper
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 10)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 10)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
data_test
ci
t(matrix(c(10, 1, 1, 1, 10, 1, 1, 1, 10, 1, 1, 1, 10, 10, 10),
nrow = 5))
gamma_hyper
gamma_init <- diag(4)
diag(4)
gamma_init <- cbind(diag(4), rep(1, 4))
gamma_init
gamma_init <- rbind(rep(1, 5), cbind(diag(4), rep(1, 4)))
gamma_init
gamma_init <- rbind(rep(1, 5), cbind(diag(4), rep(1, 4)), rep(0, 5))
gamma_init
gamma_init <- rbind(rep(1, 5), cbind(diag(4), rep(1, 4)), rep(0, 5)) * 10
gamma_init <- rbind(rep(1, 5), cbind(diag(4), rep(1, 4)), c(1, 0, 1, 0, 1)) * 10
gamma_init
gamma_init <- rbind(rep(0, 5), cbind(diag(4), rep(1, 4)), c(1, 0, 1, 0, 1)) * 10
gamma_init[gamma_init == 0] <- 1
gamma_init
ci_init <- rep(1, 50)
xi_init <- rep(15, 6)
alpha_init <- rgamma(6, xi_init, 1)
alpha_init
set.seed(20882)
gamma_init <- rbind(rep(0, 5), cbind(diag(4), rep(1, 4)), c(1, 0, 1, 0, 1)) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 6)
alpha_init <- rgamma(6, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(6, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary(salso_object)
gamma_hyper
gamma_init <- rbind(c(0, 1, 0, 1, 0),
cbind(diag(4), rep(1, 4)), c(1, 0, 1, 0, 1)) * 10
gamma_init[gamma_init == 0] <- 1
gamma_init
ci_init <- rep(1, 50)
xi_init <- rep(10, 6)
alpha_init <- rgamma(6, xi_init, 1)
set.seed(20882)
gamma_init <- rbind(c(0, 1, 0, 1, 0),
cbind(diag(4), rep(1, 4)), c(1, 0, 1, 0, 1)) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(10, 6)
alpha_init <- rgamma(6, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(6, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
test_final
total_time
test_final$alpha_update
t(test_final$alpha_update)
set.seed(20882)
gamma_init <- rbind(c(0, 1, 0, 1, 0), cbind(diag(4), rep(1, 4))) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(0, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 10)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- diag(5) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)
set.seed(20882)
gamma_init <- cbind(diag(4), rep(0, 4)) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 4)
alpha_init <- rgamma(4, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(4, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)
gamma_hyper <- cbind(diag(3), rep(0, 3)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
gamma_hyper
gamma_hyper <- t(cbind(diag(3), rep(0, 3)) * 10)
gamma_hyper[gamma_hyper == 0] <- 1
gamma_hyper
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 10)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 3)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
gamma_init <- rbind(c(0, 1, 0, 1, 0), cbind(diag(4), rep(1, 4))) * 10
gamma_init[gamma_init == 0] <- 1
gamma_init
set.seed(20882)
gamma_init <- rbind(c(0, 1, 0, 1, 0), cbind(diag(4), rep(1, 4))) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary_salso <- summary(salso_object)
summary_salso
table(summary_salso$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(20, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- cbind(diag(4), rep(1, 4)) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 3)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
gamma_hyper <- diag(4) * 10
gamma_hyper[gamma_hyper == 0] <- 1
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(20, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- diag(4) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 3)
data_test <- matrix(NA, ncol = 5, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
ci
round(nu_k, 4)
table(ci)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(20, 4)
alpha_vec <- rgamma(4, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- diag(4) * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(4, gamma_hyper[1:4, ])
sum_y <- rpois(50, 3)
data_test <- matrix(NA, ncol = 4, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- rbind(c(0, 1, 0, 1, 0), cbind(diag(4), rep(1, 4))) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
gamma_init
gamma_init <- rbind(diag(4), c(1, 0, 1, 0)) * 10
gamma_init[gamma_init == 0] <- 1
gamma_init
set.seed(20882)
gamma_init <- rbind(diag(4), c(1, 0, 1, 0)) * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(15, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary_salso <- summary(salso_object)
table(summary_salso$estimate)
