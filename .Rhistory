data_test[i, ] <- rmultinom(1, 5, nu_k[ci[i], ])
}
data_test
set.seed(20882)
gamma_init <- matrix(0.01, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 180, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 5000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 500)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6)
# nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 5, nu_k[ci[i], ])
}
nu_k
set.seed(20882)
gamma_init <- matrix(0.01, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 5000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 500)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 5, nu_k[ci[i], ])
}
data_test
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 2, nu_k[ci[i], ])
}
data_test
nu_k
set.seed(20882)
gamma_init <- matrix(0.01, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 5000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 500)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0.001, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 15000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
total_time
gamma_init
summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(0.1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 15000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:5000, ]))$estimate)
summary(salso(t(test_final$clus_assign)[2001:15000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:15000, ]))$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 50, nu_k[ci[i], ])
}
data_test
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 20, nu_k[ci[i], ])
}
data_test
nu_k
set.seed(20882)
gamma_init <- matrix(0.1, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(0.1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:15000, ]))$estimate
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0.1, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0.01, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 10, nu_k[ci[i], ])
}
data_test
nu_k
rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3)))
set.seed(20882)
gamma_init <- rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3)))
gamma_init[gamma_init == 0] <- 0.1
ci_init <- sample(1:8, 60, TRUE)
xi_init <- rep(1, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3))) * 10
gamma_init[gamma_init == 0] <- 0.1
ci_init <- sample(1:8, 60, TRUE)
xi_init <- rep(1, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3)))
gamma_init[gamma_init == 0]
ci_init <- sample(1:8, 60, TRUE)
xi_init <- rep(1, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
t(test_final$clus_assign)[2001:10000, ])
t(test_final$clus_assign)[2001:10000, ]
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 1, nu_k[ci[i], ])
}
nu_k
set.seed(20882)
gamma_init <- rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3)))
gamma_init[gamma_init == 0]
ci_init <- sample(1:8, 60, TRUE)
xi_init <- rep(1, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
t(test_final$clus_assign)[2001:10000, ])
t(test_final$clus_assign)[2001:10000, ]
ci_init
t(test_final$alpha_update)
t(test_final$alpha_update)[9991:10000, ]
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
rm(list = ls())
### Simulate the data
data_test <- rbind(t(matrix(rep(c(1, 0, 0, 0, 0), 10), ncol = 10)),
t(matrix(rep(c(0, 1, 0, 0, 0), 10), ncol = 10)),
t(matrix(rep(c(0, 0, 1, 0, 0), 10), ncol = 10)),
t(matrix(rep(c(0, 0, 0, 1, 0), 10), ncol = 10)),
t(matrix(rep(c(0, 0, 0, 0, 1), 10), ncol = 10)))
set.seed(20882)
gamma_init <- rbind(diag(5),
rbind(t(matrix(c(1, 0, 0, 0, 1), ncol = 1)),
t(matrix(c(0, 1, 0, 1, 0), ncol = 1)),
t(matrix(c(0, 1, 1, 0, 0), ncol = 1)),
t(matrix(c(1, 0, 0, 1, 0), ncol = 1)),
t(matrix(c(0, 1, 0, 0, 1), ncol = 1))))
gamma_init[gamma_init == 0] <- 0.01
ci_init <- sample(1:10, 50, TRUE)
xi_init <- rep(10, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 15.3812 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
set.seed(20882)
gamma_init <- matrix(0.01, nrow = 10, ncol = 5)
ci_init <- sample(1:10, 50, TRUE)
xi_init <- rep(10, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 17.41809 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
set.seed(20882)
gamma_init <- matrix(0.1, nrow = 10, ncol = 5)
ci_init <- sample(1:10, 50, TRUE)
xi_init <- rep(10, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 17.32481 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
set.seed(20882)
gamma_init <- matrix(100, nrow = 10, ncol = 5)
ci_init <- sample(1:10, 50, TRUE)
xi_init <- rep(10, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 20.64458 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- t(matrix(c(0.9, 0.05, 0.05, 0.05, 0.05, 0.9, 0.45, 0.45, 0.1), ncol = 3))
ci <- sort(rep(1:3, 20))
data_test <- matrix(NA, ncol = 3, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 2, nu_k[ci[i], ])
}
nu_k
set.seed(20882)
gamma_init <- rbind(diag(3), c(1, 1, 0), c(1, 0, 1), c(0, 1, 1), c(1, 1, 1))
gamma_init[gamma_init == 0] <- 0.01
ci_init <- sample(1:7, 60, TRUE)
xi_init <- rep(1, 7)
alpha_init <- rgamma(7, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(7, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 17.09277 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0.001, ncol = 3, nrow = 12)
ci_init <- sample(1:12, 60, TRUE)
xi_init <- rep(1, 12)
alpha_init <- rgamma(12, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(12, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 1, nu_k[ci[i], ])
}
set.seed(20882)
gamma_init <- rbind(c(rep(0, 3), rep(1, 3)), diag(6), c(rep(1, 3), rep(0, 3)))
gamma_init[gamma_init == 0]
ci_init <- sample(1:8, 60, TRUE)
xi_init <- rep(1, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
gamma_init
t(test_final$alpha_update)[9991:10000, ]
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
rm(list = ls())
### Data Simulation
set.seed(20882)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 5, nu_k[ci[i], ])
}
nu_k
set.seed(20882)
gamma_init <- matrix(0.01, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 18.3613 secs
total_time
gamma_init
t(test_final$alpha_update)[9991:10000, ]
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
set.seed(20882)
gamma_init <- matrix(0.001, ncol = 6, nrow = 10)
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter,
TRUE, 1000)
total_time <- Sys.time() - start_time ## 22.64364 secs
gamma_init
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate)
