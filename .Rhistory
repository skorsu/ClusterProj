}
data_test
set.seed(20882)
gamma_init <- rbind(diag(6),
rbind(t(matrix(c(1, 0, 0, 0, 1, 1), ncol = 1)),
t(matrix(c(0, 1, 0, 1, 0, 0), ncol = 1)),
t(matrix(c(0, 1, 1, 0, 0, 1), ncol = 1)),
t(matrix(c(1, 0, 0, 1, 0, 0), ncol = 1))))
gamma_init[gamma_init == 0] <- 0.1
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
rm(list = ls())
### Data Simulation
set.seed(31807)
nu_k <- diag(6) * 0.5
nu_k[nu_k == 0] <- 0.1
ci <- sort(rep(1:6, 10))
data_test <- matrix(NA, ncol = 6, nrow = 60)
for(i in 1:60){
data_test[i, ] <- rmultinom(1, 3, nu_k[ci[i], ])
}
data_test
set.seed(20882)
gamma_init <- rbind(diag(6),
rbind(t(matrix(c(1, 0, 0, 0, 1, 1), ncol = 1)),
t(matrix(c(0, 1, 0, 1, 0, 0), ncol = 1)),
t(matrix(c(0, 1, 1, 0, 0, 1), ncol = 1)),
t(matrix(c(1, 0, 0, 1, 0, 0), ncol = 1)))) * 5
gamma_init[gamma_init == 0] <- 1
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(10, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
test_final
t(test_final$alpha_update)
t(test_final$clus_assign)
summary(salso(t(test_final$clus_assign)[2001:10000, ]))
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
t(test_final$clus_assign)[2001:10000, ]
salso(t(test_final$clus_assign)[2001:10000, ])
summary(salso(t(test_final$clus_assign)[2001:10000, ]))
set.seed(20882)
gamma_init <- rbind(diag(6),
rbind(t(matrix(c(1, 0, 0, 0, 1, 1), ncol = 1)),
t(matrix(c(0, 1, 0, 1, 0, 0), ncol = 1)),
t(matrix(c(0, 1, 1, 0, 0, 1), ncol = 1)),
t(matrix(c(1, 0, 0, 1, 0, 0), ncol = 1)))) * 50
gamma_init[gamma_init == 0] <- 10
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))
set.seed(20882)
gamma_init <- rbind(diag(6),
rbind(t(matrix(c(1, 0, 0, 0, 1, 1), ncol = 1)),
t(matrix(c(0, 1, 0, 1, 0, 0), ncol = 1)),
t(matrix(c(0, 1, 1, 0, 0, 1), ncol = 1)),
t(matrix(c(1, 0, 0, 1, 0, 0), ncol = 1)))) * 0.5
gamma_init[gamma_init == 0] <- 0.1
ci_init <- sample(1:10, 60, TRUE)
xi_init <- rep(1, 10)
alpha_init <- rgamma(10, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(10, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
?salso
rm(list = ls())
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,4), size = 100, replace = TRUE, prob = psi)
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
table(ci)
alpha_vec
c(80, 10, 10)
matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
nu_k
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
data_test <- matrix(NA, ncol = 3, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, 2, nu_k[ci[i], ])
}
data_test
matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 80, 80), ncol = 3)
t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 80, 80), ncol = 5))
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 80, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
data_test <- matrix(NA, ncol = 3, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, 1, nu_k[ci[i], ])
}
alpha_vec
table(ci)
nu_k
data_test
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 80, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
data_test <- matrix(NA, ncol = 3, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, 2, nu_k[ci[i], ])
}
alpha_vec
table(ci)
nu_k
data_test
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 80, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
summary(salso(t(test_final$clus_assign)[2001:10000, ]))$estimate
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(3,3)
alpha_vec <- rgamma(3, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,3), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80), ncol = 3)
nu_k <- rdirichlet(3, gamma_hyper[1:3, ])
data_test <- matrix(NA, ncol = 3, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, 2, nu_k[ci[i], ])
}
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
uninstall()
compileAttributes()
build()
install()
library(ClusterProj)
set.seed(20882)
gamma_init <- t(matrix(c(80, 10, 10, 10, 80, 10, 10, 10, 80,
10, 10, 10, 80, 10, 80), ncol = 5))
ci_init <- sample(1:5, 50, TRUE)
xi_init <- rep(1, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
