gamma_hyper
nu_k <- rdirichlet(2, gamma_hyper)
round(nu_k, 4)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 2)
alpha_vec <- rgamma(2, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,2), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- matrix(0.1, ncol = 10, nrow = 2)
gamma_hyper[1, 8] <- 1
gamma_hyper[2, 4] <- 1
nu_k <- rdirichlet(2, gamma_hyper)
round(nu_k, 4)
sum_y <- rpois(100, 2)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 2)
alpha_vec <- rgamma(2, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,2), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- matrix(0.1, ncol = 10, nrow = 2)
gamma_hyper[1, 8] <- 1
gamma_hyper[2, 4] <- 1
nu_k <- rdirichlet(2, gamma_hyper)
sum_y <- rpois(30, 3)
data_test <- matrix(NA, ncol = 10, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
table(ci)
round(nu_k, 4)
data_test
gamma_init <- matrix(0.1, ncol = 10, nrow = 5)
gamma_init
gamma_init <- matrix(0.1, ncol = 10, nrow = 5)
gamma_init[1, 8] <- 1
gamma_init[2, 4] <- 1
gamma_init[3, 3] <- 1
gamma_init[4, 5] <- 1
gamma_init[5, 1] <- 1
gamma_init[5, 1]
gamma_init
set.seed(20882)
gamma_init <- matrix(0.1, ncol = 10, nrow = 5)
gamma_init[1, 8] <- 1
gamma_init[2, 4] <- 1
gamma_init[3, 3] <- 1
gamma_init[4, 5] <- 1
gamma_init[5, 1] <- 1
ci_init <- rep(5, 30)
xi_init <- rep(10, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
t(test_final$alpha_update)
total_time
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary_salso <- summary(salso_object)
table(summary_salso$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 2)
alpha_vec <- rgamma(2, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,2), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- matrix(1, ncol = 10, nrow = 2)
gamma_hyper[1, 8] <- 10
gamma_hyper[2, 4] <- 10
nu_k <- rdirichlet(2, gamma_hyper)
sum_y <- rpois(30, 3)
data_test <- matrix(NA, ncol = 10, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 2)
alpha_vec <- rgamma(2, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,2), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- matrix(1, ncol = 10, nrow = 2)
gamma_hyper[1, 8] <- 10
gamma_hyper[2, 4] <- 10
nu_k <- rdirichlet(2, gamma_hyper)
sum_y <- rpois(30, 5)
data_test <- matrix(NA, ncol = 10, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- c(5, 15)
alpha_vec <- rgamma(2, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,2), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- matrix(1, ncol = 10, nrow = 2)
gamma_hyper[1, 8] <- 10
gamma_hyper[2, 4] <- 10
nu_k <- rdirichlet(2, gamma_hyper)
sum_y <- rpois(30, 5)
data_test <- matrix(NA, ncol = 10, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- matrix(1, ncol = 10, nrow = 5)
gamma_init[1, 8] <- 10
gamma_init[2, 4] <- 10
gamma_init[3, 3] <- 10
gamma_init[4, 5] <- 10
gamma_init[5, 1] <- 10
ci_init <- rep(5, 30)
xi_init <- rep(10, 5)
alpha_init <- rgamma(5, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(5, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
salso_object <- salso(t(test_final$clus_assign)[-(1:1000), ])
summary_salso <- summary(salso_object)
table(summary_salso$estimate)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(8, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 100, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 10
gamma_hyper[gamma_hyper == 0] <- 5
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(100, 5)
data_test <- matrix(NA, ncol = 10, nrow = 100)
for(i in 1:100){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
gamma_init
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)[9990:10000, ]
t(test_final$alpha_update)[9990:10000, ]
t(test_final$alpha_update)[9990:10000, ]
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(8, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 100, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 10
gamma_hyper[gamma_hyper == 0] <- 5
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(100, 10)
data_test <- matrix(NA, ncol = 10, nrow = 100)
for(i in 1:100){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
data_test
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(8, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 100, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 10
gamma_hyper[gamma_hyper == 0] <- 5
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(100, 30)
data_test <- matrix(NA, ncol = 10, nrow = 100)
for(i in 1:100){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(8, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 100, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(100, 30)
data_test <- matrix(NA, ncol = 10, nrow = 100)
for(i in 1:100){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)[9990:10000, ]
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 100, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 100
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(100, 30)
data_test <- matrix(NA, ncol = 10, nrow = 100)
for(i in 1:100){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 100
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)[9990:10000, ]
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 100
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(50, 30)
data_test <- matrix(NA, ncol = 10, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 100
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 50, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 100
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(50, 5)
data_test <- matrix(NA, ncol = 10, nrow = 50)
for(i in 1:50){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 100
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 100)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
rm(list = ls())
### Data Simulation
set.seed(20882)
### Assignment vector
xi <- rep(10, 5)
alpha_vec <- rgamma(5, xi, 1)
psi <- alpha_vec/sum(alpha_vec)
ci <- sample(seq(1,5), size = 30, replace = TRUE, prob = psi)
gamma_hyper <- diag(10)[1:5, ] * 10
gamma_hyper[gamma_hyper == 0] <- 1
nu_k <- rdirichlet(5, gamma_hyper)
sum_y <- rpois(30, 5)
data_test <- matrix(NA, ncol = 10, nrow = 30)
for(i in 1:30){
data_test[i, ] <- rmultinom(1, sum_y[i], nu_k[ci[i], ])
}
round(nu_k, 4)
table(ci)
table(ci)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 50)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 100
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)[9990:10000, ]
t(test_final$alpha_update)[50:100, ]
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 3
total_iter <- 10000
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 3
total_iter <- 200
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 3
total_iter <- 150
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 3
total_iter <- 100
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
set.seed(20882)
gamma_init <- diag(10)[1:8, ] * 10
gamma_init[gamma_init == 0] <- 1
ci_init <- rep(1, 30)
xi_init <- rep(10, 8)
alpha_init <- rgamma(8, xi_init, 1)
a_theta <- 0.5
b_theta <- 0.5
sm_loop <- 10
total_iter <- 100
start_time <- Sys.time()
test_final <- cluster_func(8, ci_init, alpha_init, xi_init, data_test,
gamma_init, a_theta, b_theta, sm_loop, total_iter)
total_time <- Sys.time() - start_time
total_time
t(test_final$alpha_update)[50:100, ]
t(test_final$clus_assign)[50:100, ]
t(test_final$clus_assign)[25:101, ]
summary(salso(t(test_final$clus_assign)[25:101, ]))
summary(salso(t(test_final$clus_assign)[25:101, ]))$estimate
table(summary(salso(t(test_final$clus_assign)[25:101, ]))$estimate)
